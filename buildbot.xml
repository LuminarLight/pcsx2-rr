<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="ReleaseAll" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <!-- Add all the projects that use the non-standard configurations here. -->
  <ItemGroup>
    <TargetsSetCPU Include="plugins\GSdx"/>
  </ItemGroup>
  <!-- Add all the solutions here. -->
  <ItemGroup>
    <SolutionSet Include="$(MSBuildProjectDirectory)\PCSX2_suite.sln" />
    <!--SolutionSet Include="$(MSBuildProjectDirectory)\old_plugins.sln" /-->
    <ProjectSetCPU Include="$(MSBuildProjectDirectory)\PCSX2_suite.sln" />
  </ItemGroup>
  <!-- Add common build  properties here. -->
  <PropertyGroup>
    <CreateHardLinksIfPossible>true</CreateHardLinksIfPossible>
    <CompileFastPlz>
      BuildInParallel=True;
      CreateHardLinksForCopyFilesToOutputDirectoryIfPossible=$(CreateHardLinksIfPossible);
      CreateHardLinksForCopyAdditionalFilesIfPossible=$(CreateHardLinksIfPossible);
      CreateHardLinksForCopyLocalIfPossible=$(CreateHardLinksIfPossible);
      CreateHardLinksForPublishFilesIfPossible=$(CreateHardLinksIfPossible);
    </CompileFastPlz>
  </PropertyGroup>
  <!-- Add all the custom targets here. -->
  <Target Name="InternalBuild" AfterTargets="DebugAll;DevelAll;ReleaseAll;AppVeyor;GithubActions">
    <MSBuild Projects="@(SolutionSet)" BuildInParallel="true" Properties="Configuration=$(BaseConfiguration)" />
    <MSBuild Projects="@(ProjectSetCPU)" BuildInParallel="true" Properties="Configuration=%(ConfigCPU.Identity)" />
    <MSBuild Projects="@(SolutionSet)" BuildInParallel="true" Properties="Configuration=$(BaseConfiguration);$(CompileFastPlz)" Targets="Build" />
    <MSBuild Projects="@(ProjectSetCPU)" BuildInParallel="true" Properties="Configuration=%(ConfigCPU.Identity);BuildProjectReferences=false;$(CompileFastPlz)" Targets="@(TargetsSetCPU)" />
  </Target>
  <Target Name="DebugAll">
    <PropertyGroup>
      <BaseConfiguration>Debug</BaseConfiguration>
    </PropertyGroup>
    <ItemGroup>
      <ConfigCPU Include="Debug"/>
      <!--ConfigCPU Include="Debug AVX2;Debug SSE4"/-->
    </ItemGroup>
  </Target>
  <Target Name="DevelAll">
    <PropertyGroup>
      <BaseConfiguration>Devel</BaseConfiguration>
    </PropertyGroup>
    <ItemGroup>
      <ConfigCPU Include="Devel"/>
      <!--ConfigCPU Include="Devel AVX2;Devel SSE4"/-->
    </ItemGroup>
  </Target>
  <Target Name="ReleaseAll">
    <PropertyGroup>
      <BaseConfiguration>Release</BaseConfiguration>
    </PropertyGroup>
    <ItemGroup>
      <ConfigCPU Include="Release AVX2;Release SSE4"/>
    </ItemGroup>
  </Target>
  <Target Name="GithubActions">
    <PropertyGroup>
      <BaseConfiguration>Release</BaseConfiguration>
      <BuildInParallel>true</BuildInParallel>
    </PropertyGroup>
    <ItemGroup>
      <ConfigCPU Include="Release AVX2"/>
    </ItemGroup>
  </Target>
  <Target Name="AppVeyor">
    <PropertyGroup>
      <BaseConfiguration>Release</BaseConfiguration>
    </PropertyGroup>
    <ItemGroup>
      <ConfigCPU Include="Release AVX2"/>
    </ItemGroup>
  </Target>
</Project>
